steps:
  - group: "${GROUP?}"
    steps:
      - label: ":macos: build ${TRIPLET?}"
        key: "build_${TRIPLET?}"
        plugins:
          - JuliaCI/external-buildkite#v1:
              version: "./.buildkite-external-version"
              repo_url: "https://github.com/JuliaCI/julia-buildkite"
        timeout_in_minutes: ${TIMEOUT?}
        soft_fail: ${ALLOW_FAIL?}
        commands: |
          if [[ ${BUILD?} == 1 ]]; then
            bash .buildkite/utilities/build_julia.sh
          fi
        agents:
          queue: "julia"
          os: "macos"
          arch: "${ARCH?}"
        env:
          # Receive some environment mappings from our templating engine
          TRIPLET: "${TRIPLET?}"
          MAKE_FLAGS: "${MAKE_FLAGS?}"
